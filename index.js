(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Base:()=>a,Checkbox:()=>c,Constant:()=>u,Dropdown:()=>f});var n={};t.r(n),t.d(n,{CastBloodMagic:()=>d,Test:()=>y});var o={};t.r(o),t.d(o,{dialogs:()=>n,elements:()=>e});var r,l=function(){function t(t){var e=this,n=t.title,o=t.elements,r=t.buttons,l=t.template;this.buttons={},this.d="",this.title=n,this.elements=o,this.html=this.parseElements(o).reduce((function(t,e){return e.apply(t)}),l),Object.entries(r).forEach((function(t){var n=t[0],o=t[1];o.default&&(e.d=n);var r=o.callback?function(t){return o.callback(e.extract(t))}:void 0;e.buttons[n]={icon:'<i class="fas fa-'+o.icon+'"></i>',label:o.label,callback:r}})),this.dialog=new Dialog({title:this.title,content:this.html,buttons:this.buttons,default:this.d})}return t.prototype.render=function(){this.dialog.render(!0)},t.prototype.extract=function(t){var e={};return Object.entries(this.elements).map((function(t){return{key:t[0],val:t[1]}})).forEach((function(n){var o=n.key,r=n.val;return e[o]=r.extract(t)})),e},t.prototype.parseElements=function(t){return Object.values(t)},t}(),a=function(){function t(t){this.key=t}return t.prototype.apply=function(t){return this.key?t.replaceAll("#{"+this.key+"}",this.injectHtml()):t},t.prototype.getElement=function(t){return t.find("#"+this.key)[0]},t}(),i=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(e,n){var o=t.call(this,e)||this;return o.label=n.label,o.checked=n.default,o}return i(e,t),e.prototype.injectHtml=function(){return"<div>\n    "+(this.label?'<label for="'+this.key+'">'+this.label+"</label>":"")+'\n    <input type="checkbox" id="'+this.key+'" name="'+this.key+" "+(this.checked?"checked":"")+'">\n      </div>'},e.prototype.extract=function(t){return this.getElement(t).checked},e}(a),s=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=function(t){function e(e){var n=t.call(this)||this;return n.value=e,n}return s(e,t),e.prototype.injectHtml=function(){return""},e.prototype.extract=function(t){return this.value},e}(a),p=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),f=function(t){function e(e,n){var o=t.call(this,e)||this;return o.parms=n,o}return p(e,t),e.prototype.injectHtml=function(){return"\n    "+(this.parms.label?'<label for="'+this.key+'">'+this.parms.label+"</label>":"")+'\n    <select id="'+this.key+'" name="'+this.key+'">'+this.parms.options.map((function(t){return"<option>"+t.label+"</option>"}))+"</select>\n    "},e.prototype.extract=function(t){return this.parms.options[this.getElement(t).selectedIndex].value},e}(a),h=[4,8,12,16,20,25,30,35,40],d=new l({title:"Blood Magic Cost",elements:{costs:new u(h),level:new f("level",{label:"Spell Level:",options:h.map((function(t,e){return{label:""+(e+1),value:e+1}}))}),bp:new c("BloodPoints",{label:"Spend blood point to reduce cost?"}),chat:new c("SendToChat",{label:"Send to chat?",default:!0}),update:new c("Update",{label:"Send updates to character sheet?",default:!0})},buttons:{confirm:{icon:"skull",label:"Cast!",callback:function(t){var e=game.user.character,n=t.bp?1:0,o=t.costs[t.level-1]-3*n,r=(Math.floor(o/2),new Roll("1d20 < @dc",{dc:t.level}));r.evaluate()&&ChatMessage.create({user:game.user._id,roll:r,type:CONST.CHAT_MESSAGE_TYPES.ROLL}),t.chat&&ChatMessage.create({user:game.user._id,content:e.name+" cast a blood magic spell at level "+t.level+" by spending "+o+" health and "+n+" blood points",type:CONST.CHAT_MESSAGE_TYPES.EMOTE})}}},template:'<h1>Select spell level</h1>\n<div>\n  <label for="level">Spell level: </label>\n  <select id="level" name="level" required>\n    ${options}\n  </select>\n</div>\n\n#{BloodPoints}\n\n<h2>costs:</h2>\n<div>\n  <label for="bloodCost">Blood Points: </label>\n  <output id="bloodCost"></output>\n</div>\n<div>\n  <label for="healthCost">HP: </label>\n  <output id="healthCost"></output>\n</div>\n<div>\n  <label for="corruptionCost">Corruption: </label>\n  <output id="corruptionCost"></output>\n</div>\n\n<h2>options:</h2>\n#{SendToChat} #{Update}\n'}),b={yay:{default:!0,label:"The default button"},echo:{default:!0,icon:"play",label:"Echo!",callback:function(t){console.log("TheBox: "+(t.theBox?"yes":"no"))}}},y=new l({title:"A test",elements:{theBox:new c("theBox",{label:"This is a test checkbox"})},buttons:b,template:""});Hooks.once("ready",(function(){game.nova=o}))})();